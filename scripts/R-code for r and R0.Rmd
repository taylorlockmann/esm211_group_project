---
title: "Untitled"
author: "Craig Stuart"
date: "3/1/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(popbio)
library(tidyverse)
```

Calculate R0 with p values
```{r}
R0_calculated<-c()
for(i in seq(from = 0.1, to = 1, by=0.01)) {
  R0=3844*(i)^5
  R0_calculated <- c(R0_calculated, R0)
  }

R0_calculated
```


Calculate R0 with p values
```{r}
#Make a vector of the p values we used to calculate R0
pvalue <- c()
pvalue[1] = 0.1
for(i in 2:91) {
  pvalue[i] = pvalue[i-1]+0.01
}

pvalue

#Make a data frame of the two vectors
R0_data <- data.frame(R0_calculated, pvalue)

ggplot(R0_data, aes(x = pvalue, y = R0_calculated)) +
  geom_line()

#This is my exploratory plot of R0
plot(my_vec, pch = 16, ylab = "R0", xlab = "p")
#Make this into a dataframe
#ggplot, geom_vline
```

Build Age Structure Matrix Model

```{r}
#Define the ages 
stages = c("0", "1")


#Define the matrix
A = matrix(c(0,3844,0.5,0),nrow=2, byrow=T,dimnames=list(stages,stages))

#check the matrix
A

#Define an initial population structure
N0=c(20,20)

#Project the matrix population model K time steps
K<-50
projA=pop.projection(A,N0,K)

#the population growth rate (lambda). Above 1, population growth. Below 1, populaiton decline.
projA$lambda

#Plot the population size projection
plot(projA$pop.size,pch=16, type='b',ylab="Population Size",xlab="Time Step")
```

